{"version":3,"file":"list-profiles-stories.a49b2d87.iframe.bundle.js","mappings":";;;;AA4DA;AAKA;AAGA;;;;;;AAMA;AAGA;;;AAGA;;AAGA;;;;;;;;;;;AAcA;ACxFA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACmBA;;;;AASA;AC8BA;;AAMA;;;AAIA;;AA4BA;AAGA;;;AAOA;AACA;;;;;AAOA;;;;AAKA;AAGA;;;AAGA;;AAEA;;AAYA;AAEA;;;AAMA;AACA;;AAIA;;;;;;AApIA;;;;;;;;;;ACNA;;;;AAWA;;ACiCA;;;;AAKA;AACA;;;;AAIA;;;;AAMA;;;;AAUA;AAEA;AACA;AAEA;;;;AAtEA;ACfA;;;AAOA","sources":["webpack://@holochain-open-dev/profiles-dev/./node_modules/@holochain-open-dev/elements/dist/elements/holo-identicon.js","webpack://@holochain-open-dev/profiles-dev/./node_modules/@shoelace-style/shoelace/dist/chunks/chunk.MQ7QFCHP.js","webpack://@holochain-open-dev/profiles-dev/./node_modules/@shoelace-style/shoelace/dist/chunks/chunk.KLGGXJV3.js","webpack://@holochain-open-dev/profiles-dev/../../src/elements/agent-avatar.ts","webpack://@holochain-open-dev/profiles-dev/../../src/elements/profile-list-item-skeleton.ts","webpack://@holochain-open-dev/profiles-dev/../../src/elements/list-profiles.ts","webpack://@holochain-open-dev/profiles-dev/./stories/list-profiles.stories.js"],"sourcesContent":["var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { css, html, LitElement } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators.js\";\nimport renderIcon from \"@holo-host/identicon\";\nimport { classMap } from \"lit/directives/class-map.js\";\nimport { encodeHashToBase64 } from \"@holochain/client\";\nimport { localized, msg } from \"@lit/localize\";\nimport \"@shoelace-style/shoelace/dist/components/tooltip/tooltip.js\";\nimport { hashProperty } from \"../holo-hash-property.js\";\nlet HoloIdenticon = class HoloIdenticon extends LitElement {\n    constructor() {\n        super(...arguments);\n        /**\n         * Size of the identicon in pixels.\n         */\n        this.size = 32;\n        /**\n         * Shape of the identicon.\n         */\n        this.shape = \"circle\";\n        this.justCopiedHash = false;\n    }\n    async copyHash() {\n        await navigator.clipboard.writeText(this.strHash);\n        if (this.timeout)\n            clearTimeout(this.timeout);\n        this.justCopiedHash = true;\n        this._tooltip.show();\n        this.timeout = setTimeout(() => {\n            this._tooltip.hide();\n            setTimeout(() => {\n                this.justCopiedHash = false;\n            }, 100);\n        }, 2000);\n    }\n    get strHash() {\n        return encodeHashToBase64(this.hash);\n    }\n    updated(changedValues) {\n        super.updated(changedValues);\n        if ((changedValues.has(\"hash\") &&\n            changedValues.get(\"hash\")?.toString() !== this.hash?.toString()) ||\n            changedValues.has(\"size\") ||\n            changedValues.has(\"value\")) {\n            renderIcon({\n                hash: this.hash,\n                size: this.size,\n            }, this._canvas);\n        }\n    }\n    renderCanvas() {\n        return html ` <canvas\n      id=\"canvas\"\n      width=\"1\"\n      height=\"1\"\n      class=${classMap({\n            square: this.shape === \"square\",\n            circle: this.shape === \"circle\",\n        })}\n    ></canvas>`;\n    }\n    render() {\n        return html `<div\n      @click=${() => this.copyHash()}\n      style=\"cursor: pointer; flex-grow: 0\"\n    >\n      <sl-tooltip\n        id=\"tooltip\"\n        placement=\"top\"\n        .content=${this.justCopiedHash\n            ? msg(\"Copied!\")\n            : `${this.strHash.substring(0, 6)}...`}\n        .trigger=${this.justCopiedHash ? \"manual\" : \"hover focus\"}\n        hoist\n      >\n        ${this.renderCanvas()}\n      </sl-tooltip>\n    </div>`;\n    }\n    static get styles() {\n        return css `\n      :host {\n        display: flex;\n      }\n\n      .square {\n        border-radius: 0%;\n      }\n      .circle {\n        border-radius: 50%;\n      }\n    `;\n    }\n};\n__decorate([\n    property(hashProperty(\"hash\"))\n], HoloIdenticon.prototype, \"hash\", void 0);\n__decorate([\n    property({ type: Number })\n], HoloIdenticon.prototype, \"size\", void 0);\n__decorate([\n    property({ type: String })\n], HoloIdenticon.prototype, \"shape\", void 0);\n__decorate([\n    query(\"#canvas\")\n], HoloIdenticon.prototype, \"_canvas\", void 0);\n__decorate([\n    query(\"#tooltip\")\n], HoloIdenticon.prototype, \"_tooltip\", void 0);\n__decorate([\n    state()\n], HoloIdenticon.prototype, \"justCopiedHash\", void 0);\nHoloIdenticon = __decorate([\n    localized(),\n    customElement(\"holo-identicon\")\n], HoloIdenticon);\nexport { HoloIdenticon };\n//# sourceMappingURL=holo-identicon.js.map","import {\n  component_styles_default\n} from \"./chunk.BCEYT3RT.js\";\nimport {\n  i\n} from \"./chunk.DUT32TWM.js\";\n\n// src/components/skeleton/skeleton.styles.ts\nvar skeleton_styles_default = i`\n  ${component_styles_default}\n\n  :host {\n    --border-radius: var(--sl-border-radius-pill);\n    --color: var(--sl-color-neutral-200);\n    --sheen-color: var(--sl-color-neutral-300);\n\n    display: block;\n    position: relative;\n  }\n\n  .skeleton {\n    display: flex;\n    width: 100%;\n    height: 100%;\n    min-height: 1rem;\n  }\n\n  .skeleton__indicator {\n    flex: 1 1 auto;\n    background: var(--color);\n    border-radius: var(--border-radius);\n  }\n\n  .skeleton--sheen .skeleton__indicator {\n    background: linear-gradient(270deg, var(--sheen-color), var(--color), var(--color), var(--sheen-color));\n    background-size: 400% 100%;\n    background-size: 400% 100%;\n    animation: sheen 8s ease-in-out infinite;\n  }\n\n  .skeleton--pulse .skeleton__indicator {\n    animation: pulse 2s ease-in-out 0.5s infinite;\n  }\n\n  /* Forced colors mode */\n  @media (forced-colors: active) {\n    :host {\n      --color: GrayText;\n    }\n  }\n\n  @keyframes sheen {\n    0% {\n      background-position: 200% 0;\n    }\n    to {\n      background-position: -200% 0;\n    }\n  }\n\n  @keyframes pulse {\n    0% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.4;\n    }\n    100% {\n      opacity: 1;\n    }\n  }\n`;\n\nexport {\n  skeleton_styles_default\n};\n","import {\n  skeleton_styles_default\n} from \"./chunk.MQ7QFCHP.js\";\nimport {\n  o\n} from \"./chunk.ORW72H2K.js\";\nimport {\n  ShoelaceElement,\n  e,\n  e2\n} from \"./chunk.ROLL4627.js\";\nimport {\n  y\n} from \"./chunk.DUT32TWM.js\";\nimport {\n  __decorateClass\n} from \"./chunk.LKA3TPUC.js\";\n\n// src/components/skeleton/skeleton.ts\nvar SlSkeleton = class extends ShoelaceElement {\n  constructor() {\n    super(...arguments);\n    this.effect = \"none\";\n  }\n  render() {\n    return y`\n      <div\n        part=\"base\"\n        class=${o({\n      skeleton: true,\n      \"skeleton--pulse\": this.effect === \"pulse\",\n      \"skeleton--sheen\": this.effect === \"sheen\"\n    })}\n      >\n        <div part=\"indicator\" class=\"skeleton__indicator\"></div>\n      </div>\n    `;\n  }\n};\nSlSkeleton.styles = skeleton_styles_default;\n__decorateClass([\n  e2()\n], SlSkeleton.prototype, \"effect\", 2);\nSlSkeleton = __decorateClass([\n  e(\"sl-skeleton\")\n], SlSkeleton);\n\nexport {\n  SlSkeleton\n};\n","import { consume } from \"@lit-labs/context\";\nimport { hashProperty, sharedStyles } from \"@holochain-open-dev/elements\";\nimport { css, html, LitElement } from \"lit\";\nimport { state, property, customElement } from \"lit/decorators.js\";\nimport { styleMap } from \"lit-html/directives/style-map.js\";\nimport { AgentPubKey, encodeHashToBase64 } from \"@holochain/client\";\nimport { localized, msg } from \"@lit/localize\";\nimport { StoreSubscriber } from \"@holochain-open-dev/stores\";\nimport { SlTooltip } from \"@shoelace-style/shoelace\";\n\nimport \"@holochain-open-dev/elements/elements/display-error.js\";\nimport \"@holochain-open-dev/elements/elements/holo-identicon.js\";\nimport \"@shoelace-style/shoelace/dist/components/avatar/avatar.js\";\nimport \"@shoelace-style/shoelace/dist/components/skeleton/skeleton.js\";\nimport \"@shoelace-style/shoelace/dist/components/tooltip/tooltip.js\";\n\nimport { profilesStoreContext } from \"../context.js\";\nimport { ProfilesStore } from \"../profiles-store.js\";\nimport { Profile } from \"../types.js\";\n\n@localized()\n@customElement(\"agent-avatar\")\nexport class AgentAvatar extends LitElement {\n  /** Public properties */\n\n  /**\n   * REQUIRED. The public key identifying the agent whose profile is going to be shown.\n   */\n  @property(hashProperty(\"agent-pub-key\"))\n  agentPubKey!: AgentPubKey;\n\n  /**\n   * Size of the avatar image in pixels.\n   */\n  @property({ type: Number })\n  size = 32;\n\n  /**\n   * Copy AgentPubKey to clipboard on click\n   */\n  @property({ type: Boolean })\n  copyOnClick = false;\n\n  /**\n   * Show tooltip on hover with truncated AgentPubKey\n   */\n  @property({ type: Boolean })\n  showOnHover = false;\n\n  /** Dependencies */\n\n  /**\n   * Profiles store for this element, not required if you embed this element inside a <profiles-context>\n   */\n  @consume({ context: profilesStoreContext, subscribe: true })\n  @property()\n  store!: ProfilesStore;\n\n  /**\n   * @internal\n   */\n  private _agentProfile = new StoreSubscriber(this, () =>\n    this.store.profiles.get(this.agentPubKey)\n  );\n\n  renderIdenticon() {\n    return html` <div\n      style=${styleMap({\n        position: \"relative\",\n        height: `${this.size}px`,\n        width: `${this.size}px`,\n      })}\n    >\n      <holo-identicon .hash=${this.agentPubKey} .size=${this.size}>\n      </holo-identicon>\n      <div class=\"badge\"><slot name=\"badge\"></slot></div>\n    </div>`;\n  }\n\n  @state()\n  justCopiedHash = false;\n\n  timeout: any;\n\n  async copyHash() {\n    await navigator.clipboard.writeText(encodeHashToBase64(this.agentPubKey));\n\n    if (this.timeout) clearTimeout(this.timeout);\n\n    this.justCopiedHash = true;\n    (this.shadowRoot!.getElementById(\"tooltip\") as SlTooltip).show();\n\n    this.timeout = setTimeout(() => {\n      (this.shadowRoot!.getElementById(\"tooltip\") as SlTooltip).hide();\n      setTimeout(() => {\n        this.justCopiedHash = false;\n      }, 100);\n    }, 2000);\n  }\n\n  renderProfile(profile: Profile | undefined) {\n    if (!profile || !profile.fields.avatar) return this.renderIdenticon();\n\n    const contents = html`\n      <div\n        @click=${() => {\n          if (this.copyOnClick) this.copyHash();\n        }}\n        style=${styleMap({\n          position: \"relative\",\n          height: `${this.size}px`,\n          width: `${this.size}px`,\n        })}\n      >\n        <sl-avatar\n          .image=${profile.fields.avatar}\n          style=\"--size: ${this.size}px;\"\n        >\n        </sl-avatar>\n        <div class=\"badge\"><slot name=\"badge\"></slot></div>\n      </div>\n    `;\n\n    return this.showOnHover ?\n      html`\n        <sl-tooltip\n          id=\"tooltip\"\n          placement=\"top\"\n          .content=${this.justCopiedHash\n            ? msg(\"Copied!\")\n            : `${encodeHashToBase64(this.agentPubKey).substring(0, 6)}...`}\n          .trigger=${this.justCopiedHash ? \"manual\" : \"hover focus\"}\n          hoist\n        >\n          ${contents}\n        </sl-tooltip>\n      ` : \n      contents;\n  }\n\n  render() {\n    if (this.store.config.avatarMode === \"identicon\")\n      return this.renderIdenticon();\n\n    switch (this._agentProfile.value.status) {\n      case \"pending\":\n        return html`<sl-skeleton\n          effect=\"pulse\"\n          style=\"height: ${this.size}px; width: ${this.size}px\"\n        ></sl-skeleton>`;\n      case \"complete\":\n        return this.renderProfile(this._agentProfile.value.value);\n      case \"error\":\n        return html`\n          <display-error\n            tooltip\n            .headline=${msg(\"Error fetching the agent's avatar\")}\n            .error=${this._agentProfile.value.error.data.data}\n          ></display-error>\n        `;\n    }\n  }\n\n  static styles = [\n    sharedStyles,\n    css`\n      .badge {\n        position: absolute;\n        right: 0;\n        bottom: 0;\n      }\n    `,\n  ];\n}\n","import { css, html, LitElement } from \"lit\";\nimport { customElement } from \"lit/decorators.js\";\nimport { sharedStyles } from \"@holochain-open-dev/elements\";\n\nimport \"@shoelace-style/shoelace/dist/components/skeleton/skeleton.js\";\n\n/**\n * @element profile-list-item-skeleton\n */\n@customElement(\"profile-list-item-skeleton\")\nexport class ProfileListItemSkeleton extends LitElement {\n  render() {\n    return html`<div class=\"row\" style=\"align-items: center; width: 150px\">\n      <sl-skeleton\n        effect=\"sheen\"\n        style=\"height: 32px; width: 32px; border-radius: 50%; margin: 8px\"\n      ></sl-skeleton\n      ><sl-skeleton\n        effect=\"sheen\"\n        style=\"flex: 1; margin: 8px; border-radius: 12px\"\n      >\n      </sl-skeleton>\n    </div>`;\n  }\n\n  static get styles() {\n    return [\n      sharedStyles,\n      css`\n        :host {\n          display: flex;\n        }\n      `,\n    ];\n  }\n}\n","import { css, html, LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\nimport { AgentPubKey } from \"@holochain/client\";\nimport { consume } from \"@lit-labs/context\";\nimport { sharedStyles } from \"@holochain-open-dev/elements\";\nimport { StoreSubscriber } from \"@holochain-open-dev/stores\";\nimport { localized, msg } from \"@lit/localize\";\n\nimport \"@holochain-open-dev/elements/elements/display-error.js\";\nimport \"./agent-avatar.js\";\nimport \"./profile-list-item-skeleton.js\";\n\nimport { ProfilesStore } from \"../profiles-store\";\nimport { profilesStoreContext } from \"../context\";\nimport { Profile } from \"../types\";\n\n/**\n * @element list-profiles\n * @fires agent-selected - Fired when the user selects an agent from the list. Detail will have this shape: { agentPubKey: <AGENT_PUB_KEY as Uint8Array> }\n */\n@localized()\n@customElement(\"list-profiles\")\nexport class ListProfiles extends LitElement {\n  /**\n   * Profiles store for this element, not required if you embed this element inside a <profiles-context>\n   */\n  @consume({ context: profilesStoreContext, subscribe: true })\n  @property()\n  store!: ProfilesStore;\n\n  /** Private properties */\n\n  /**\n   * @internal\n   */\n  private _allProfiles = new StoreSubscriber(\n    this,\n    () => this.store.allProfiles\n  );\n\n  initials(nickname: string): string {\n    return nickname\n      .split(\" \")\n      .map((name) => name[0])\n      .join(\"\");\n  }\n\n  fireAgentSelected(agentPubKey: AgentPubKey) {\n    if (agentPubKey) {\n      this.dispatchEvent(\n        new CustomEvent(\"agent-selected\", {\n          bubbles: true,\n          composed: true,\n          detail: {\n            agentPubKey,\n          },\n        })\n      );\n    }\n  }\n\n  renderList(profiles: ReadonlyMap<AgentPubKey, Profile>) {\n    if (profiles.size === 0)\n      return html`<span>${msg(\"There are no created profiles yet\")} ></span>`;\n\n    return html`\n      <div style=\"min-width: 80px; flex: 1;\" }>\n        ${Array.from(profiles.entries()).map(\n          ([agent_pub_key, profile]) => html`\n            <div class=\"row\" style=\"align-items: center; margin-bottom: 16px;\">\n              <agent-avatar\n                style=\"margin-right: 8px;\"\n                .agentPubKey=${agent_pub_key}\n                @click=${() => this.fireAgentSelected(agent_pub_key)}\n                showOnHover\n              >\n              </agent-avatar\n              ><span> ${profile.nickname}</span>\n            </div>\n          `\n        )}\n      </div>\n    `;\n  }\n\n  render() {\n    switch (this._allProfiles.value.status) {\n      case \"pending\":\n        return html`<div class=\"column center-content\">\n          <profile-list-item-skeleton> </profile-list-item-skeleton>\n          <profile-list-item-skeleton> </profile-list-item-skeleton>\n          <profile-list-item-skeleton> </profile-list-item-skeleton>\n        </div>`;\n      case \"error\":\n        return html`<display-error\n          .headline=${msg(\"Error fetching the profiles for all agents\")}\n          .error=${this._allProfiles.value.error.data.data}\n        ></display-error>`;\n      case \"complete\":\n        return this.renderList(this._allProfiles.value.value);\n    }\n  }\n\n  static styles = [\n    sharedStyles,\n    css`\n      :host {\n        display: flex;\n      }\n    `,\n  ];\n}\n","import { html } from \"lit-html\";\nimport \"@holochain-open-dev/profiles/elements/list-profiles.js\";\nimport \"@holochain-open-dev/profiles/elements/profiles-context.js\";\nimport { ProfilesZomeMock } from \"@holochain-open-dev/profiles/mocks\";\nimport { ProfilesStore, ProfilesClient } from \"@holochain-open-dev/profiles\";\n\n// More on how to set up stories at: https://storybook.js.org/docs/7.0/web-components/writing-stories/introduction\nexport default {\n  title: \"Frontend/Elements/list-profiles\",\n  tags: [\"autodocs\"],\n  component: \"list-profiles\",\n  render: (args) =>\n    html` <profiles-context\n      .store=${new ProfilesStore(new ProfilesClient(new ProfilesZomeMock()))}\n    >\n      <list-profiles />\n    </profiles-context>`,\n};\n\n// More on writing stories with args: https://storybook.js.org/docs/7.0/web-components/writing-stories/args\nexport const Demo = {};\n"],"names":[],"sourceRoot":""}